using RepairTool.Repairs.Activities.Global;
using System;

namespace RepairTool.Repairs.Activities.Malware
{
    public static class MalwareScans
    {
        public static void RunScans()
        {
            EnvironmentVars.WarningsDetected = false;
            Console.Title = "Windows Repair Tool - Malware Scans - TDSSK - " + EnvironmentVars.APPVERSION;
            RootkitKiller.RunTask();
            EnvironmentVars.WarningsDetected = false;
            Console.Title = "Windows Repair Tool - Malware Scans - McAfee Stinger - " + EnvironmentVars.APPVERSION;
            Stinger.RunTask();
            EnvironmentVars.WarningsDetected = false;
            Console.Title = "Windows Repair Tool - Malware Scans - Malwarebytes - " + EnvironmentVars.APPVERSION;
            MalwareBytes.Install();
            MalwareBytes.Close();
            MalwareBytes.KillTray();
            MalwareBytes.InstallConfig();
            MalwareBytes.RulesInstaller();
            MalwareBytes.Scan();
            MalwareBytes.Cleanup();
            EnvironmentVars.WarningsDetected = false;
            Console.Title = "Windows Repair Tool - Malware Scans - Kaspersky - " + EnvironmentVars.APPVERSION;
            Kaspersky.VirusRemovalTool();
            EnvironmentVars.WarningsDetected = false;
            Console.Title = "Windows Repair Tool - Malware Scans - Sophos - " + EnvironmentVars.APPVERSION;
            Sophos.WebCheckSophos();
            Sophos.RunScan();
            Sophos.Cleanup();
            EnvironmentVars.WarningsDetected = false;
            GlobalTaskRunner.Run();
        }
    }
}